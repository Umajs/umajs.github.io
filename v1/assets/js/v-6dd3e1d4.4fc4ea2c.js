"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[30],{950:(s,a,n)=>{n.r(a),n.d(a,{default:()=>x});var l=n(4386);const e=(0,l._)("h1",{id:"修饰器-decorator",tabindex:"-1"},[(0,l._)("a",{class:"header-anchor",href:"#修饰器-decorator","aria-hidden":"true"},"#"),(0,l.Uk)(" 修饰器（Decorator）")],-1),p=(0,l._)("p",null,"框架大量功能都是以 Decorator（修饰器）的方式使用。",-1),o=(0,l._)("h3",{id:"resource、-inject-修饰器",tabindex:"-1"},[(0,l._)("a",{class:"header-anchor",href:"#resource、-inject-修饰器","aria-hidden":"true"},"#"),(0,l.Uk)(" @Resource、@Inject 修饰器")],-1),r=(0,l.Uk)("IOC 参考文档"),t=(0,l._)("h3",{id:"service-修饰器",tabindex:"-1"},[(0,l._)("a",{class:"header-anchor",href:"#service-修饰器","aria-hidden":"true"},"#"),(0,l.Uk)(" @Service 修饰器")],-1),c=(0,l.Uk)("Service 参考文档"),F=(0,l._)("h3",{id:"aspect-修饰器",tabindex:"-1"},[(0,l._)("a",{class:"header-anchor",href:"#aspect-修饰器","aria-hidden":"true"},"#"),(0,l.Uk)(" @Aspect 修饰器")],-1),y=(0,l.Uk)("Acpect 参考文档"),i=(0,l._)("h3",{id:"path",tabindex:"-1"},[(0,l._)("a",{class:"header-anchor",href:"#path","aria-hidden":"true"},"#"),(0,l.Uk)(" @Path")],-1),D=(0,l.Uk)("Router 参考文档"),u=(0,l.Uk)("框架在 "),m=(0,l._)("code",null,"@Path",-1),C=(0,l.Uk)(" 装饰器的基础上还提供了一些其它快捷的路由装饰器 "),d=(0,l.Uk)("@umajs/path"),b=(0,l._)("h3",{id:"private-修饰器",tabindex:"-1"},[(0,l._)("a",{class:"header-anchor",href:"#private-修饰器","aria-hidden":"true"},"#"),(0,l.Uk)(" @Private 修饰器")],-1),A=(0,l.Uk)("Router 参考文档"),h=(0,l._)("h3",{id:"param、-query-修饰器",tabindex:"-1"},[(0,l._)("a",{class:"header-anchor",href:"#param、-query-修饰器","aria-hidden":"true"},"#"),(0,l.Uk)(" @Param、@Query 修饰器")],-1),B=(0,l.Uk)("Router 参考文档"),g=(0,l.uE)('<h3 id="自定义参数装饰器-createargdecorator" tabindex="-1"><a class="header-anchor" href="#自定义参数装饰器-createargdecorator" aria-hidden="true">#</a> 自定义参数装饰器 createArgDecorator</h3><h4 id="注意" tabindex="-1"><a class="header-anchor" href="#注意" aria-hidden="true">#</a> 注意</h4><blockquote><p>从 v1.1.* 版本开始，<code>createArgDecorator</code> 更新了参数方式，使传入参数不受一个的限制。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#8B949E;">// v1.0.*</span></span>\n<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createArgDecorator</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">fn</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">argKey</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">ctx</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">IContext</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">...</span><span style="color:#FFA657;">argProps</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">[]) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ParameterDecorator</span><span style="color:#C9D1D9;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#8B949E;">// v1.1.*</span></span>\n<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createArgDecorator</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">fn</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">ctx</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">IContext</span><span style="color:#C9D1D9;">, </span><span style="color:#FF7B72;">...</span><span style="color:#FFA657;">argProps</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">[]) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">...</span><span style="color:#FFA657;">argProps</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">[]) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ParameterDecorator</span><span style="color:#C9D1D9;">;</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="示例如下" tabindex="-1"><a class="header-anchor" href="#示例如下" aria-hidden="true">#</a> 示例如下</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#0d1117;"><code><span class="line"><span style="color:#8B949E;">// user.controller.ts</span></span>\n<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { BaseController, Param } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;@umajs/core&#39;</span></span>\n<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { AgeCheck } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;../decorator/AgeCheck&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">class</span><span style="color:#FFA657;"> User </span><span style="color:#FF7B72;">extends</span><span style="color:#FFA657;"> </span><span style="color:#79C0FF;">BaseController</span><span style="color:#FFA657;"> {</span></span>\n<span class="line"><span style="color:#FFA657;">  </span><span style="color:#D2A8FF;">save</span><span style="color:#FFA657;">(@</span><span style="color:#D2A8FF;">Param</span><span style="color:#FFA657;">(</span><span style="color:#A5D6FF;">&#39;name&#39;</span><span style="color:#FFA657;">) name</span><span style="color:#FF7B72;">:</span><span style="color:#FFA657;"> </span><span style="color:#79C0FF;">string</span><span style="color:#FFA657;">, @</span><span style="color:#D2A8FF;">AgeCheck</span><span style="color:#FFA657;">(</span><span style="color:#A5D6FF;">&#39;age&#39;</span><span style="color:#FFA657;">) age</span><span style="color:#FF7B72;">:</span><span style="color:#FFA657;"> </span><span style="color:#79C0FF;">number</span><span style="color:#FFA657;">) </span><span style="color:#C9D1D9;">{</span></span>\n<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// ...</span></span>\n<span class="line"><span style="color:#C9D1D9;">  }</span></span>\n<span class="line"><span style="color:#FFA657;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#8B949E;">// decorator/AgeCheck.ts</span></span>\n<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { createArgDecorator, Result, IContext } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;@umajs/core&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#8B949E;">/**</span></span>\n<span class="line"><span style="color:#8B949E;"> * 1、参数的聚合 Model</span></span>\n<span class="line"><span style="color:#8B949E;"> * 2、参数的校验</span></span>\n<span class="line"><span style="color:#8B949E;"> * 3、参数的转换</span></span>\n<span class="line"><span style="color:#8B949E;"> * 4、便捷方法</span></span>\n<span class="line"><span style="color:#8B949E;"> * 5、utils、config 等也可以通过此装饰器快速引用</span></span>\n<span class="line"><span style="color:#8B949E;"> */</span></span>\n<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">AgeCheck</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createArgDecorator</span><span style="color:#C9D1D9;">((</span><span style="color:#FFA657;">ctx</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">IContext</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">ageKey</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>\n<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> age </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> ctx.query[ageKey]</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (age </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">undefined</span><span style="color:#C9D1D9;">)</span></span>\n<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> Result.</span><span style="color:#D2A8FF;">json</span><span style="color:#C9D1D9;">({</span></span>\n<span class="line"><span style="color:#C9D1D9;">      code: </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">,</span></span>\n<span class="line"><span style="color:#C9D1D9;">      msg: </span><span style="color:#A5D6FF;">&#39;请加上 age 参数&#39;</span><span style="color:#C9D1D9;">,</span></span>\n<span class="line"><span style="color:#C9D1D9;">    })</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C9D1D9;">  age </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;">age</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">Number</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">isNaN</span><span style="color:#C9D1D9;">(age) </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> age </span><span style="color:#FF7B72;">&lt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> age </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">120</span><span style="color:#C9D1D9;">)</span></span>\n<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> Result.</span><span style="color:#D2A8FF;">json</span><span style="color:#C9D1D9;">({</span></span>\n<span class="line"><span style="color:#C9D1D9;">      code: </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">,</span></span>\n<span class="line"><span style="color:#C9D1D9;">      msg: </span><span style="color:#A5D6FF;">&#39;请传入正确的 age 参数&#39;</span><span style="color:#C9D1D9;">,</span></span>\n<span class="line"><span style="color:#C9D1D9;">    })</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> age</span></span>\n<span class="line"><span style="color:#C9D1D9;">})</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div>',6),E={id:"框架提供的参数装饰器-参数装饰",tabindex:"-1"},f=(0,l._)("a",{class:"header-anchor",href:"#框架提供的参数装饰器-参数装饰","aria-hidden":"true"},"#",-1),v=(0,l.Uk)(" 框架提供的参数装饰器 "),_=(0,l.Uk)("参数装饰"),k={},x=(0,n(4110).Z)(k,[["render",function(s,a){const n=(0,l.up)("RouterLink");return(0,l.wg)(),(0,l.iD)(l.HY,null,[e,p,o,(0,l._)("p",null,[(0,l.Wm)(n,{to:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/IOC.html#resource%E3%80%81-inject%E4%BF%AE%E9%A5%B0%E5%99%A8"},{default:(0,l.w5)((()=>[r])),_:1})]),t,(0,l._)("p",null,[(0,l.Wm)(n,{to:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/IOC.html#service%E4%BF%AE%E9%A5%B0%E5%99%A8"},{default:(0,l.w5)((()=>[c])),_:1})]),F,(0,l._)("p",null,[(0,l.Wm)(n,{to:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/AOP.html#aspect%E4%BF%AE%E9%A5%B0%E5%99%A8"},{default:(0,l.w5)((()=>[y])),_:1})]),i,(0,l._)("p",null,[(0,l.Wm)(n,{to:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/Router.html#path%E4%BF%AE%E9%A5%B0%E5%99%A8"},{default:(0,l.w5)((()=>[D])),_:1})]),(0,l._)("p",null,[u,m,C,(0,l.Wm)(n,{to:"/other/path.html"},{default:(0,l.w5)((()=>[d])),_:1})]),b,(0,l._)("p",null,[(0,l.Wm)(n,{to:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/Router.html##private%E4%BF%AE%E9%A5%B0%E5%99%A8"},{default:(0,l.w5)((()=>[A])),_:1})]),h,(0,l._)("p",null,[(0,l.Wm)(n,{to:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/Router.html##param%E3%80%81-query%E4%BF%AE%E9%A5%B0%E5%99%A8"},{default:(0,l.w5)((()=>[B])),_:1})]),g,(0,l._)("h4",E,[f,v,(0,l.Wm)(n,{to:"/other/ArgDecorator.html"},{default:(0,l.w5)((()=>[_])),_:1})])],64)}]])},9674:(s,a,n)=>{n.r(a),n.d(a,{data:()=>l});const l={key:"v-6dd3e1d4",path:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/Decorator.html",title:"修饰器（Decorator）",lang:"zh-CN",frontmatter:{head:[["meta",{property:"og:url",content:"/v1/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/Decorator.html"}],["meta",{property:"og:site_name",content:"UMajs"}],["meta",{property:"og:title",content:"修饰器（Decorator）"}],["meta",{property:"og:type",content:"article"}],["meta",{property:"og:locale",content:"zh-CN"}],["meta",{property:"og:locale:alternate",content:"en-US"}],["meta",{name:"twitter:card",content:"summary_large_image"}],["meta",{name:"twitter:image:alt",content:"UMajs"}],["meta",{property:"article:author",content:"JiaZeng"}],["meta",{property:"og:restrictions:age",content:"3+"}],["meta",{name:"twitter:creator",content:"UMajs"}]]},excerpt:"",headers:[{level:3,title:"@Resource、@Inject 修饰器",slug:"resource、-inject-修饰器",children:[]},{level:3,title:"@Service 修饰器",slug:"service-修饰器",children:[]},{level:3,title:"@Aspect 修饰器",slug:"aspect-修饰器",children:[]},{level:3,title:"@Path",slug:"path",children:[]},{level:3,title:"@Private 修饰器",slug:"private-修饰器",children:[]},{level:3,title:"@Param、@Query 修饰器",slug:"param、-query-修饰器",children:[]},{level:3,title:"自定义参数装饰器 createArgDecorator",slug:"自定义参数装饰器-createargdecorator",children:[]}],filePathRelative:"基础功能/Decorator.md",git:{updatedTime:1630481998e3,contributors:[{name:"jiazengp",email:"jiazengp@gmail.com",commits:1}]}}},4110:(s,a)=>{a.Z=(s,a)=>{for(const[n,l]of a)s[n]=l;return s}}}]);