(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{392:function(s,a,t){"use strict";t.r(a);var n=t(44),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"插件-plugin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件-plugin"}},[s._v("#")]),s._v(" 插件（Plugin）")]),s._v(" "),t("h2",{attrs:{id:"为什么使用插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么使用插件"}},[s._v("#")]),s._v(" 为什么使用插件")]),s._v(" "),t("p",[t("code",[s._v("Uma")]),s._v(" 的插件内部机制就是借用了 "),t("code",[s._v("Koa")]),s._v(" 的中间件，但是仅有中间件无法满足框架的扩展，另外中间件的配置对于业务多样性解决也偏单一。")]),s._v(" "),t("p",[t("code",[s._v("Uma")]),s._v(" 使用插件进行框架层面拓展，不仅可以使用中间件模式进行扩展，还可以采用复合模式对 context、request、response 进行扩展，还可以对中间件的使用场景进行快速开发，例如 results(返回值)、use(无设定场景)、filter(对符合条件的路由加载中间件)、ignore(对符合条件之外的路由加载中间件)、method(对 MethodType 符合的请求加载中间件)")]),s._v(" "),t("h2",{attrs:{id:"插件使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件使用"}},[s._v("#")]),s._v(" 插件使用")]),s._v(" "),t("h3",{attrs:{id:"插件安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件安装"}},[s._v("#")]),s._v(" 插件安装")]),s._v(" "),t("p",[s._v("插件可以通过npm方式进行安装。"),t("code",[s._v("Uma")]),s._v("官方提供的插件一般使用"),t("code",[s._v("@umajs/plugin-")]),s._v("作为前缀，方便我们去搜索。同时"),t("code",[s._v("Uma")]),s._v("也可以加载应用目录内的用户自定义插件"),t("code",[s._v("plugins")]),s._v("目录。框架在读取配置后，插件的加载优先级如下：")]),s._v(" "),t("ol",[t("li",[s._v("{URSA_ROOT}/plugins/{packageName}")]),s._v(" "),t("li",[s._v("{URSA_ROOT}/node_modules/{packageName}")])]),s._v(" "),t("h3",{attrs:{id:"插件配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件配置"}},[s._v("#")]),s._v(" 插件配置")]),s._v(" "),t("p",[s._v("插件一般有默认配置，我们也可以通过自定义配置来覆盖原有配置。")]),s._v(" "),t("p",[s._v("插件的配置在config目录下的"),t("code",[s._v("plugin.config.ts")]),s._v("文件中，插件顺序按照 "),t("code",[s._v("config/plugin.config.ts")]),s._v(" 配置的顺序进行加载。")]),s._v(" "),t("blockquote",[t("p",[s._v("注意：插件的顺序会影响到插件调用其它插件的功能。")])]),s._v(" "),t("h4",{attrs:{id:"插件配置说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件配置说明"}},[s._v("#")]),s._v(" 插件配置说明")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" type TPluginConfig "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    enable"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" boolean        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 是否开启插件，默认值false")]),s._v("\n    name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" string           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 插件名，可选")]),s._v("\n    packageName"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" string    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// npm包名，可选，如不填写时，默认值为`@umajs/plugin-$")]),s._v("\n    options"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" object        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 框架会将此配置用参数形式传给插件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("blockquote",[t("p",[s._v("当 [pluginName].config.ts 存在时， 会和配置混合后传给插件")])]),s._v(" "),t("h4",{attrs:{id:"插件配置实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件配置实例"}},[s._v("#")]),s._v(" 插件配置实例")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// config/plugin.config.ts")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error-handler'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        enable"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error-handler'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        packageName"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@umajs/plugin-error-handler'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        options"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            foo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 插件的实际配置")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("如果只需开启插件或关闭插件，可以简化配置写法：")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// config/plugin.config.ts")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error-handler'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"插件开发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件开发"}},[s._v("#")]),s._v(" "),t("RouterLink",{attrs:{to:"/插件/dev.html"}},[s._v("插件开发")])],1)])}),[],!1,null,null,null);a.default=e.exports}}]);