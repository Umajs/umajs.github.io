"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[319],{3790:(s,l,n)=>{n.r(l),n.d(l,{default:()=>K});var e=n(4386),a=n(5811),o=n(6090);const r=(0,e._)("h1",{id:"面向切面-aop",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#面向切面-aop","aria-hidden":"true"},"#"),(0,e.Uk)(" 面向切面（AOP）")],-1),c=(0,e._)("p",null,"AOP(Aspect Oriented Programming)面向切面编程是与 OOP(Object Oriented Programming)面向对象编程并列的编程思想。相对于 IOC(依赖注入)而言，AOP 是一种可以在不修改源代码的情况下给程序动态添加功能的一种方式。",-1),_=(0,e._)("p",null,"使用 AOP 可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。",-1),t=(0,e._)("h2",{id:"什么是切面-aspect",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#什么是切面-aspect","aria-hidden":"true"},"#"),(0,e.Uk)(" 什么是切面(Aspect)")],-1),p=(0,e._)("p",null,"AOP 名为面向切面编程，所以切面(Aspect)是 AOP 中一个很关键的点。",-1),F=(0,e._)("p",null,"比如假设我们有一个订单系统，有如下两条线的功能，提交订单和查询订单，每个事件流都需要执行“验证用户信息”的操作，将这个功能框起来后，你可以把它当块板子，这块板子插入了一些控制流程，这块板子就可以当成是 AOP 中的一个切面。",-1),i=(0,e._)("p",null,[(0,e._)("img",{src:a,alt:"AOP"})],-1),y=(0,e._)("h2",{id:"如何创建-aspect",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#如何创建-aspect","aria-hidden":"true"},"#"),(0,e.Uk)(" 如何创建 Aspect")],-1),D=(0,e._)("p",null,"在 Uma 中定义一个 Aspect 需要遵循以下几点规范：",-1),u=(0,e._)("ol",null,[(0,e._)("li",null,[(0,e.Uk)("框架会扫描"),(0,e._)("code",null,"${URSA_ROOT}/aspect"),(0,e.Uk)("目录下的文件读取 Aspect，所以，所有的 Aspect 文件都必须放在"),(0,e._)("code",null,"app/aspect"),(0,e.Uk)("目录下，支持多级目录")]),(0,e._)("li",null,[(0,e.Uk)("所有 Aspect 文件的命名需要按照"),(0,e._)("code",null,"名称.aspect.ts"),(0,e.Uk)("的格式，以"),(0,e._)("code",null,".aspect.ts"),(0,e.Uk)("为后缀名，使用时 Aspect 的名称会取.aspect 前的文件名")]),(0,e._)("li",null,[(0,e.Uk)("Aspect 类需要实现"),(0,e._)("code",null,"IAspect接口")])],-1),A=(0,e._)("p",null,[(0,e.Uk)("例如，我们在"),(0,e._)("code",null,"${URSA_ROOT}/aspect"),(0,e.Uk)("目录下创建一个"),(0,e._)("code",null,"test.aspect.ts"),(0,e.Uk)("：")],-1),b=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#0d1117"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#8B949E"}},"// app/aspect/test.aspect.ts")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"import"),(0,e._)("span",{style:{color:"#C9D1D9"}}," { IAspect, IJoinPoint } "),(0,e._)("span",{style:{color:"#FF7B72"}},"from"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#A5D6FF"}},"'@umajs/core'")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"default"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"class"),(0,e._)("span",{style:{color:"#FFA657"}}," Test "),(0,e._)("span",{style:{color:"#FF7B72"}},"implements"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"IAspect"),(0,e._)("span",{style:{color:"#FFA657"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"before"),(0,e._)("span",{style:{color:"#FFA657"}},"(point"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," IJoinPoint) "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    console."),(0,e._)("span",{style:{color:"#D2A8FF"}},"log"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'index: this is before:'"),(0,e._)("span",{style:{color:"#C9D1D9"}},", point.target)")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br")])],-1),d=(0,e._)("p",null,"该方法实现了一个切面，切面定义了前置通知方法，我们会在下面介绍通知",-1),m=(0,e._)("h2",{id:"通知",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#通知","aria-hidden":"true"},"#"),(0,e.Uk)(" 通知")],-1),k=(0,e._)("p",null,[(0,e._)("code",null,"通知"),(0,e.Uk)("是 AOP 中一个很重要的概念，所谓通知指的就是在拦截到方法之后要执行的代码。通知分为前置(before)、后置(after)、异常(afterThrowing)、最终(afterReturning)、环绕(around)通知五类。")],-1),C=(0,e._)("ul",null,[(0,e._)("li",null,"前置通知：在目标方法之前执行"),(0,e._)("li",null,"后置通知：在目标方法之后执行"),(0,e._)("li",null,"异常通知：当执行目标方法出现异常时调用"),(0,e._)("li",null,"最终通知：当目标方法有返回值之后执行，在后置通知之后"),(0,e._)("li",null,"环绕通知：在最开始调用时执行，会将目标方法作为参数传入，对目标方法(proceed)及入参(args)、出参(result)进行拦截，此方法必须返回 Result")],-1),U=(0,e._)("p",null,"在 Uma 中我们对这 5 个通知都做了实现，你需要先在 aspect 文件中定义这些通知，然后在 controller 中通过修饰器的方式使用它。",-1),B=(0,e._)("h3",{id:"切面实现",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#切面实现","aria-hidden":"true"},"#"),(0,e.Uk)(" 切面实现")],-1),h=(0,e._)("p",null,[(0,e.Uk)("可以选择性的实现 "),(0,e._)("code",null,"IAspect"),(0,e.Uk)(" 的方法（一个或者多个），调用的时候可以通过 "),(0,e._)("code",null,"Aspect(aspect)"),(0,e.Uk)(" 调用全部实现方法，或者通过 "),(0,e._)("code",null,"Aspect.around(aspect)"),(0,e.Uk)(" 、"),(0,e._)("code",null,"Aspect.afterThrowing(aspect)"),(0,e.Uk)(" 等方法调用某一个具体方法。")],-1),g=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#0d1117"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"import"),(0,e._)("span",{style:{color:"#C9D1D9"}}," { IAspect, IJoinPoint, IProceedJoinPoint } "),(0,e._)("span",{style:{color:"#FF7B72"}},"from"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#A5D6FF"}},"'@umajs/core'")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"default"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"class"),(0,e._)("span",{style:{color:"#FFA657"}}," Method "),(0,e._)("span",{style:{color:"#FF7B72"}},"implements"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"IAspect"),(0,e._)("span",{style:{color:"#FFA657"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"before"),(0,e._)("span",{style:{color:"#FFA657"}},"(point"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," IJoinPoint) "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// 前置通知")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"after"),(0,e._)("span",{style:{color:"#FFA657"}},"(point"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," IJoinPoint) "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// 后置通知")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#FF7B72"}},"async"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#D2A8FF"}},"around"),(0,e._)("span",{style:{color:"#FFA657"}},"(proceedPoint"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," IProceedJoinPoint) "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"const"),(0,e._)("span",{style:{color:"#C9D1D9"}}," { "),(0,e._)("span",{style:{color:"#79C0FF"}},"proceed"),(0,e._)("span",{style:{color:"#C9D1D9"}},", "),(0,e._)("span",{style:{color:"#79C0FF"}},"args"),(0,e._)("span",{style:{color:"#C9D1D9"}}," } "),(0,e._)("span",{style:{color:"#FF7B72"}},"="),(0,e._)("span",{style:{color:"#C9D1D9"}}," proceedPoint")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// 环绕通知before")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"return"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"await"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#D2A8FF"}},"proceed"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#FF7B72"}},"..."),(0,e._)("span",{style:{color:"#C9D1D9"}},"args)")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// 环绕通知after")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"afterThrowing"),(0,e._)("span",{style:{color:"#FFA657"}},"(e"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," Error) "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// 异常通知")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"afterReturning"),(0,e._)("span",{style:{color:"#FFA657"}},"(point"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," IJoinPoint, result"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"any"),(0,e._)("span",{style:{color:"#FFA657"}},") "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// 返回通知")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br")])],-1),x=(0,e._)("p",null,[(0,e.Uk)("其中"),(0,e._)("code",null,"IJoinPoint"),(0,e.Uk)("和"),(0,e._)("code",null,"IProceedJoinPoint"),(0,e.Uk)("类型声明为")],-1),f=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#0d1117"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"interface"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FFA657"}},"IJoinPoint"),(0,e._)("span",{style:{color:"#C9D1D9"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  "),(0,e._)("span",{style:{color:"#FFA657"}},"target"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FFA657"}},"Object"),(0,e._)("span",{style:{color:"#C9D1D9"}},"; "),(0,e._)("span",{style:{color:"#8B949E"}},"// controller 实例")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  "),(0,e._)("span",{style:{color:"#FFA657"}},"args"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FFA657"}},"Array"),(0,e._)("span",{style:{color:"#C9D1D9"}},"<"),(0,e._)("span",{style:{color:"#79C0FF"}},"any"),(0,e._)("span",{style:{color:"#C9D1D9"}},">; "),(0,e._)("span",{style:{color:"#8B949E"}},"// 方法参数")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"interface"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FFA657"}},"IProceedJoinPoint"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"extends"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"IJoinPoint"),(0,e._)("span",{style:{color:"#C9D1D9"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"proceed"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FFA657"}},"Function"),(0,e._)("span",{style:{color:"#C9D1D9"}},"; "),(0,e._)("span",{style:{color:"#8B949E"}},"// 方法，Around 专属")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),P=(0,e._)("p",null,"一个目标上可以作用多个 Aspect，多个 Aspect 的执行顺序为包裹型，具体执行顺序见下图：",-1),E=(0,e._)("p",null,[(0,e._)("img",{src:o,alt:"images"})],-1),O=(0,e._)("h2",{id:"aspect-修饰器",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#aspect-修饰器","aria-hidden":"true"},"#"),(0,e.Uk)(" @Aspect 修饰器")],-1),v=(0,e._)("p",null,[(0,e.Uk)("在 Uma 中，通过修饰器"),(0,e._)("code",null,"@Aspect"),(0,e.Uk)("的方式使用 Aspect")],-1),I=(0,e._)("h3",{id:"_1-作用点",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_1-作用点","aria-hidden":"true"},"#"),(0,e.Uk)(" 1. 作用点")],-1),j=(0,e._)("p",null,[(0,e._)("code",null,"@Aspect"),(0,e.Uk)("修饰器可以作用在某个 controller 的"),(0,e._)("code",null,"class"),(0,e.Uk)("上或者 controller 的"),(0,e._)("code",null,"某个方法"),(0,e.Uk)("上")],-1),R=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#0d1117"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#8B949E"}},"// 作用在class上")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"@"),(0,e._)("span",{style:{color:"#D2A8FF"}},"Aspect"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'test1'"),(0,e._)("span",{style:{color:"#C9D1D9"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"default"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"class"),(0,e._)("span",{style:{color:"#FFA657"}}," Index "),(0,e._)("span",{style:{color:"#FF7B72"}},"extends"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"BaseController"),(0,e._)("span",{style:{color:"#FFA657"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#8B949E"}},"// 作用在方法上")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  @"),(0,e._)("span",{style:{color:"#D2A8FF"}},"Aspect"),(0,e._)("span",{style:{color:"#FFA657"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'test2'"),(0,e._)("span",{style:{color:"#FFA657"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"index"),(0,e._)("span",{style:{color:"#FFA657"}},"() "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"return"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"this"),(0,e._)("span",{style:{color:"#C9D1D9"}},"."),(0,e._)("span",{style:{color:"#D2A8FF"}},"send"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'这里是首页'"),(0,e._)("span",{style:{color:"#C9D1D9"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br")])],-1),J=(0,e._)("p",null,"作用在 Class 上的 Aspect 会被应用于 Class 的所有方法上",-1),w=(0,e._)("h3",{id:"_2-语法",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_2-语法","aria-hidden":"true"},"#"),(0,e.Uk)(" 2. 语法")],-1),T=(0,e._)("p",null,[(0,e._)("code",null,"@Aspect"),(0,e.Uk)("修饰器有两种语法形式")],-1),S=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("对目标使用 Aspect 中的所有通知："),(0,e._)("strong",null,"@Aspect('xx')")]),(0,e._)("li",null,[(0,e.Uk)("对目标使用 Aspect 中指定通知："),(0,e._)("strong",null,"@Aspect.before('xx')、@Aspect.after('xx')、@Aspect.afterThrowing('xx')、@Aspect.afterReturning('xx')、@Aspect.around('xx')")])],-1),$=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#0d1117"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"default"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"class"),(0,e._)("span",{style:{color:"#FFA657"}}," Index "),(0,e._)("span",{style:{color:"#FF7B72"}},"extends"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"BaseController"),(0,e._)("span",{style:{color:"#FFA657"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#8B949E"}},"// 所有通知")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  @"),(0,e._)("span",{style:{color:"#D2A8FF"}},"Aspect"),(0,e._)("span",{style:{color:"#FFA657"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'test1'"),(0,e._)("span",{style:{color:"#FFA657"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#8B949E"}},"// 指定只生效前置")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  @"),(0,e._)("span",{style:{color:"#C9D1D9"}},"Aspect"),(0,e._)("span",{style:{color:"#FFA657"}},"."),(0,e._)("span",{style:{color:"#D2A8FF"}},"before"),(0,e._)("span",{style:{color:"#FFA657"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'test2'"),(0,e._)("span",{style:{color:"#FFA657"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#8B949E"}},"// 指定只生效环绕")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  @"),(0,e._)("span",{style:{color:"#C9D1D9"}},"Aspect"),(0,e._)("span",{style:{color:"#FFA657"}},"."),(0,e._)("span",{style:{color:"#D2A8FF"}},"around"),(0,e._)("span",{style:{color:"#FFA657"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'test2'"),(0,e._)("span",{style:{color:"#FFA657"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"index"),(0,e._)("span",{style:{color:"#FFA657"}},"() "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"return"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"this"),(0,e._)("span",{style:{color:"#C9D1D9"}},"."),(0,e._)("span",{style:{color:"#D2A8FF"}},"send"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'这里是首页'"),(0,e._)("span",{style:{color:"#C9D1D9"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br")])],-1),M=(0,e._)("blockquote",null,[(0,e._)("p",null,"注意 1：around 方式可以修改被修饰方法的入参和出参，因此在部分场景返回值需要特别注意，例如在修饰 controller 方法时，未返回或者返回值类型不是 Result 时可能会提示出错。"),(0,e._)("p",null,"注意 2：afterThrowing 会捕获并拦截错误，如果不将错误抛出，上层将不会捕获错误。")],-1),z=(0,e._)("h3",{id:"中间件转环绕使用",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#中间件转环绕使用","aria-hidden":"true"},"#"),(0,e.Uk)(" 中间件转环绕使用")],-1),Z=(0,e.Uk)("Middleware 参考文档"),L=(0,e._)("h3",{id:"实例",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#实例","aria-hidden":"true"},"#"),(0,e.Uk)(" 实例")],-1),N=(0,e._)("p",null,[(0,e.Uk)("例如上面的"),(0,e._)("code",null,"${URSA_ROOT}/aspect/test.aspect.ts"),(0,e.Uk)("中我们定义了一个前置(before)通知，如果想再定义一个环绕(around)通知，可以这样修改：")],-1),q=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#0d1117"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#8B949E"}},"// ${URSA_ROOT}/aspect/test.aspect.ts")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"import"),(0,e._)("span",{style:{color:"#C9D1D9"}}," { IAspect, IJoinPoint, IProceedJoinPoint, Result } "),(0,e._)("span",{style:{color:"#FF7B72"}},"from"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#A5D6FF"}},"'@umajs/core'")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"default"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"class"),(0,e._)("span",{style:{color:"#FFA657"}}," Test "),(0,e._)("span",{style:{color:"#FF7B72"}},"implements"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"IAspect"),(0,e._)("span",{style:{color:"#FFA657"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"before"),(0,e._)("span",{style:{color:"#FFA657"}},"(point"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," IJoinPoint) "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    console."),(0,e._)("span",{style:{color:"#D2A8FF"}},"log"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'index: this is before:'"),(0,e._)("span",{style:{color:"#C9D1D9"}},", point.target)")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#8B949E"}},"// ====> 创建环绕通知")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#FF7B72"}},"async"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#D2A8FF"}},"around"),(0,e._)("span",{style:{color:"#FFA657"}},"(proceedPoint"),(0,e._)("span",{style:{color:"#FF7B72"}},":"),(0,e._)("span",{style:{color:"#FFA657"}}," IProceedJoinPoint) "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"const"),(0,e._)("span",{style:{color:"#C9D1D9"}}," { "),(0,e._)("span",{style:{color:"#79C0FF"}},"proceed"),(0,e._)("span",{style:{color:"#C9D1D9"}},", "),(0,e._)("span",{style:{color:"#79C0FF"}},"args"),(0,e._)("span",{style:{color:"#C9D1D9"}}," } "),(0,e._)("span",{style:{color:"#FF7B72"}},"="),(0,e._)("span",{style:{color:"#C9D1D9"}}," proceedPoint")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    console."),(0,e._)("span",{style:{color:"#D2A8FF"}},"log"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'index: this is around before'"),(0,e._)("span",{style:{color:"#C9D1D9"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// 判断登录，还可以做其他判断逻辑等等")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"if"),(0,e._)("span",{style:{color:"#C9D1D9"}}," ("),(0,e._)("span",{style:{color:"#FF7B72"}},"!"),(0,e._)("span",{style:{color:"#C9D1D9"}},"isLogin) "),(0,e._)("span",{style:{color:"#FF7B72"}},"return"),(0,e._)("span",{style:{color:"#C9D1D9"}}," Result."),(0,e._)("span",{style:{color:"#D2A8FF"}},"redirect"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'/login'"),(0,e._)("span",{style:{color:"#C9D1D9"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#8B949E"}},"// args 为参数，可以对参数进行判断、修改等等操作")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"const"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"result"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"="),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"await"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#D2A8FF"}},"proceed"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#FF7B72"}},"..."),(0,e._)("span",{style:{color:"#C9D1D9"}},"args)")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    console."),(0,e._)("span",{style:{color:"#D2A8FF"}},"log"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'index: this is around after'"),(0,e._)("span",{style:{color:"#C9D1D9"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"return"),(0,e._)("span",{style:{color:"#C9D1D9"}}," result")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br")])],-1),H=(0,e._)("p",null,[(0,e.Uk)("然后在"),(0,e._)("code",null,"${URSA_ROOT}/controller/index.controller.ts"),(0,e.Uk)("中使用它")],-1),W=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"shiki",style:{"background-color":"#0d1117"}},[(0,e._)("code",null,[(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#8B949E"}},"// ${URSA_ROOT}/controller/index.controller.ts")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"import"),(0,e._)("span",{style:{color:"#C9D1D9"}}," { BaseController, Path, Aspect } "),(0,e._)("span",{style:{color:"#FF7B72"}},"from"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#A5D6FF"}},"'@umajs/core'")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FF7B72"}},"export"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"default"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#FF7B72"}},"class"),(0,e._)("span",{style:{color:"#FFA657"}}," Index "),(0,e._)("span",{style:{color:"#FF7B72"}},"extends"),(0,e._)("span",{style:{color:"#FFA657"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"BaseController"),(0,e._)("span",{style:{color:"#FFA657"}}," {")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#8B949E"}},"// ===> 在这里使用")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  @"),(0,e._)("span",{style:{color:"#C9D1D9"}},"Aspect"),(0,e._)("span",{style:{color:"#FFA657"}},"."),(0,e._)("span",{style:{color:"#D2A8FF"}},"around"),(0,e._)("span",{style:{color:"#FFA657"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'test'"),(0,e._)("span",{style:{color:"#FFA657"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"index"),(0,e._)("span",{style:{color:"#FFA657"}},"() "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"return"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"this"),(0,e._)("span",{style:{color:"#C9D1D9"}},"."),(0,e._)("span",{style:{color:"#D2A8FF"}},"view"),(0,e._)("span",{style:{color:"#C9D1D9"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'index.html'"),(0,e._)("span",{style:{color:"#C9D1D9"}},", { name: "),(0,e._)("span",{style:{color:"#A5D6FF"}},"'Abc123'"),(0,e._)("span",{style:{color:"#C9D1D9"}}," })")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"}),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  @"),(0,e._)("span",{style:{color:"#D2A8FF"}},"Aspect"),(0,e._)("span",{style:{color:"#FFA657"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'test'"),(0,e._)("span",{style:{color:"#FFA657"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  @"),(0,e._)("span",{style:{color:"#D2A8FF"}},"Path"),(0,e._)("span",{style:{color:"#FFA657"}},"("),(0,e._)("span",{style:{color:"#A5D6FF"}},"'/test'"),(0,e._)("span",{style:{color:"#FFA657"}},")")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"  "),(0,e._)("span",{style:{color:"#D2A8FF"}},"test"),(0,e._)("span",{style:{color:"#FFA657"}},"() "),(0,e._)("span",{style:{color:"#C9D1D9"}},"{")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"    "),(0,e._)("span",{style:{color:"#FF7B72"}},"return"),(0,e._)("span",{style:{color:"#C9D1D9"}}," "),(0,e._)("span",{style:{color:"#79C0FF"}},"this"),(0,e._)("span",{style:{color:"#C9D1D9"}},"."),(0,e._)("span",{style:{color:"#D2A8FF"}},"json"),(0,e._)("span",{style:{color:"#C9D1D9"}},"({ test: "),(0,e._)("span",{style:{color:"#79C0FF"}},"1"),(0,e._)("span",{style:{color:"#C9D1D9"}}," })")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#C9D1D9"}},"  }")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"},[(0,e._)("span",{style:{color:"#FFA657"}},"}")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"line"})])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br")])],-1),Y=(0,e._)("p",null,[(0,e.Uk)("这样你在访问 Index/index 方法时，会先执行"),(0,e._)("code",null,"${URSA_ROOT}/aspect/test.aspect.ts"),(0,e.Uk)("中的 around 方法，index 方法被框架封装后作为参数传给 around 通知方法")],-1),G={},K=(0,n(4110).Z)(G,[["render",function(s,l){const n=(0,e.up)("RouterLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[r,c,_,t,p,F,i,y,D,u,A,b,d,m,k,C,U,B,h,g,x,f,P,E,O,v,I,j,R,J,w,T,S,$,M,z,(0,e._)("p",null,[(0,e.Wm)(n,{to:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/Middleware.html#aop-%E8%A3%85%E9%A5%B0%E5%99%A8%E5%BD%A2%E5%BC%8F"},{default:(0,e.w5)((()=>[Z])),_:1})]),L,N,q,H,W,Y],64)}]])},7571:(s,l,n)=>{n.r(l),n.d(l,{data:()=>e});const e={key:"v-6acd30a2",path:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/AOP.html",title:"面向切面（AOP）",lang:"zh-CN",frontmatter:{head:[["meta",{property:"og:url",content:"/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD/AOP.html"}],["meta",{property:"og:site_name",content:"UMajs"}],["meta",{property:"og:title",content:"面向切面（AOP）"}],["meta",{property:"og:type",content:"article"}],["meta",{property:"og:locale",content:"zh-CN"}],["meta",{property:"og:locale:alternate",content:"en-US"}],["meta",{name:"twitter:card",content:"summary_large_image"}],["meta",{name:"twitter:image:alt",content:"UMajs"}],["meta",{property:"article:author",content:"JiaZeng"}],["meta",{property:"og:restrictions:age",content:"3+"}],["meta",{name:"twitter:creator",content:"UMajs"}]]},excerpt:"",headers:[{level:2,title:"什么是切面(Aspect)",slug:"什么是切面-aspect",children:[]},{level:2,title:"如何创建 Aspect",slug:"如何创建-aspect",children:[]},{level:2,title:"通知",slug:"通知",children:[{level:3,title:"切面实现",slug:"切面实现",children:[]}]},{level:2,title:"@Aspect 修饰器",slug:"aspect-修饰器",children:[{level:3,title:"1. 作用点",slug:"_1-作用点",children:[]},{level:3,title:"2. 语法",slug:"_2-语法",children:[]},{level:3,title:"中间件转环绕使用",slug:"中间件转环绕使用",children:[]},{level:3,title:"实例",slug:"实例",children:[]}]}],filePathRelative:"基础功能/AOP.md",git:{updatedTime:1630481998e3,contributors:[{name:"jiazengp",email:"jiazengp@gmail.com",commits:1}]}}},4110:(s,l)=>{l.Z=(s,l)=>{for(const[n,e]of l)s[n]=e;return s}},5811:(s,l,n)=>{s.exports=n.p+"assets/img/AOP-aspect.d12e38eb.png"},6090:(s,l,n)=>{s.exports=n.p+"assets/img/AOP-notice.2afed41f.png"}}]);